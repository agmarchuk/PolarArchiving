
20100926 10:37
Решил переработать кассетный менеджер в технологию WPF. Вроде, получается. Появляются моменты,
которые плохо преодолеваются, но преодолеваются все же... Около часа разбирался с тем, как
организовать что-то вроде ListView с визуальными элементами, сгруппированными в виде горизонтального
разворачавающегося потока (wrap). Опять "потоптался" на тех же трудностях, с которыми мучился ранее,
сделал временное решение в виде фиксации горизонтального размера WrapPanel, но привязать этот
размер по байндингу не сумел, потом попробую найти вариант в Expression Blend. 

Что нужно еще сделать, чтобы это все стало минимально полезным? 
*1. Маленькие иконки в TreeView
2. Drag-and-Drop из системы
*3. Визуализация фоток в большом варианте
*4. Навигацию через двойной клик на иконку

Потом можно будет заняться атрибутами и их редактированием. Начну по порядку.

Сделал первый пункт. Сообразил, что потом надо будет:
*5. Сделать сортировку в ListView

А еще надо:
6. Начальное выделение
Это я могу сделать немедленно.

Кеширование фоток то ли не работает, то ли неэффективно. Видимо, надо запоминать сформированные имиджи.
Потом подумаю. 

19:36
Уже почти все подготовил к выполнению операций drag-and-drop. Но меня смущают задержки при построении 
очередного кадра. Видимо, надо в кеш сохранять что-то большее, чем источник фотки. 
Ддля начала, нужны большие данные. Так, чтобы и всех фоток было много - более тысячи и так, чтобы в 
некоторых директориях их также было много - несколько сотен. Попробую это сделать старым интерфейсом,
заодно засеку время на создание. 

Разница в скоторсных характеристиках заметна и не впользу новой разработки. Кроме того, используется раза
в полтора больше оперативной памяти... Посмотрю, что можно сделать.

20100927 17:26
Съездил на сеанс протезирования зубов - Мстислав Алексеевич поработал над моими зубами, подточил, снял мерку,
поставил временный пластмассовый протез и отпустил. Попробую поработать. Я остановился на том, что пока
не во всех режимах определяю идентификатор коллекции, в которую надо поместить "кидаемые" файлы и директории. 

Кое-какие ошибочки исправил. Сейчас задумался о том, не созранять ли мне в тегах визуальных элементов
записи, а не идентификаторы записей? Дело в том, что по идентификатору не всегда просто определить 
нужную информацию, например отличить коллекцию от документа. В принципе, разница будет тогда, когда запись
изменится на другую, да и то, тип записи измениться не может. А потом захочется ерейти на фиксацию узла,
тогда снова переделывать? Однако, поскольку в режиме drag-and-drop проверки нужно делать быстро, то лучше
зафиксировать все же запись. Попробую это переделать. 

Переделал, не так это было сложно. Теперь нет сигнала над мусорной корзиной. Но это и хорошо. Похоже, у 
мусорницы нет записи, надо будет разобраться. 

Теперь отфильтрую сигнал над документами и можно вставлять уже известный код переписи файлов и директорий
в кассету.

20100928 20:13
Сделал и старый менеджер, но меня больше интересует новый. Прикрепил работу PregressBar, теперь процесс виден.
Что выявилось или надо сделать?
*7. Нужна отмена ввода данных. Пускай какая-то часть уже введена, просто пректратить ввод. При этом, база данных
должна соответствовать уже введенным данным.
8. Есть проблемы с повторами. Если директория уже вводилась, то она (почему-то) не вводится в другое место.
Надо разобраться и сделать корректно. Надо еще определеить эту самую корректность.
9. Надо обновить дерево после ввода.
10. Надо блокировать потенциальную работу с панелями при вводе.
11. Там что-то непонятное происходит при выделении айтемов в правой панели, по крайней мере, подпись исчезает.

Потом еще чего-нибудь выявлю, а пока есть что делать...

Сделал 9-й пункт, там пришлось исправить еще затесавшуюся ошибку. Но теперь появился и десятый...
10. Надо обновлять правую панель после ввода.

20100930 19:22
Вот уже и последний день сентября. С утра хотел поработать над проектом, выяснил, что дома экземпляр проекта 
несколько устарел, пришлось отложить это желание. Написал отзыв официального оппонента по диссертации
Колташева, теперь могу себя "побаловать". Решил немного подумать о том, что и в каком порядке нужно еще
сделать. Для начала, почитаю какие пункты я намечал для работы. 

Попробую подумать над 10-м пунктом - он относительно независим от других.

С этим моментом - разобрался. Убрал установку бэкграунда и теперь работает понятно. 
Теперь многое "упирается" в визуализацию айтема. Идея, которую я обдумываю, заключается в следующем:
- породить режим визуализации айтема;
- при этом, правая панель будет работать как правая панель в проекте publicuem, а левая - как левая в
том же проекте;
- левая панель в этом режиме будет похожа на "деревянное" представление, но только не будет всего дерева,
а будет часть, связанная с выделенным айтемом;
- соответственно появятся "открытые" папки (в случае "чистого" дерева - только одна;
- появится также определяющая запись
В общем, все как в записной книжке. Только правая панель будет инициироваться "сильным" выделением, которое
будет озанчать что-то вроде "посмотри" или "посмотри контент".

Итак, имеется дерево и имеется айтем или даже несколько айтемов. Переключение между ними осуществляется табом
или, в некоторых случаях, автоматически. В режиме дерева, правая панель формируется автоматически как и сейчас.
В режиме айтема, правая панель также может формироваться автоматически, а может и по специальным сигналам.
Я пока не понял как лучше делать. Когда я буду просматривать файлы директории, мне было бы хорошо, чтобы 
срабатывал простой select. Но если я хочу проводить drag-and-drop операции, автоматичность может помешать. 

Рассмотрим пример: я обрабатываю фотки похода. Фотки выстроены в дерево и я иду от одной, к другой. А в табе
у меня упрятан список участников похода и для аннотации мне его периодически приходится привлекать. А в другом 
табе я, при необходмости произвожу поиск нужной мне сущности. 

Вспомнил про старую проблему о горизонтальном размере wrapPanel, сделал эксперименты в Бленде, частично исправил
ситуацию. Частично, потому, что размер нужно делать немного меньше, чтобы не получалось горизонтального бегунка.

И еще я увидел, что select можно делать двойным кликом. Поэкспериментирую с этим.

Похоже, показалось. Для WPF, этого не нашел. НАдо подумать над поставленными вопросами. 

20101001 08:19
Опять дата со сплошными единичками и ноликами... 
Все время думаю про наиболее удачную модель работы с данными. Некоторые вчерашние идеи я уже практически
отверг. Дело в том, что для реализации нужной глубины вложенности, приходится вводить в рассмотрение вторую панель 
изображения айтема в "столбик". Действительно, если "плясать" от контента, напр. фотографии, правая панель должна
быть занята большим изображением фотки. Следующий уровень просмотра - документ, следующий - коллекция или набор,
в котором документ содержится или ассоциирован. Поэтому мысль постепенно вернулась к TreeView, что логично, поскольку
древовидное представление как раз и предназанчено для работы с многоуровневой информацией. Основное, что тревожит -
возможное обилие информации, расположенной в дереве. Действительно, в кассете обычно единицы или десятки папок,
но тысячи документов. 

Много раз подумал, надо решаться на действие ("отрезать"). Что для этого надо. Надо сделать систему иконок для
древовидного представления. Надо "отработать" двойные клики на папки и документы. Надо выйти на режим изображения
контента документа. Ну, попробую...

12:16
Кое-что сделал, но нужно бежать на теннис. Потом продолжу...

14:36
Открыд зимний тенисный сезон. Тперь можно поработать.
Там быди пара неточностей и недоделок. Надо вспомнить каких. Во-первых, при помещении файлов в кассету по-старому
формируется поддерево. 

Еще пара ошибок:
11. При помещении директории в кассету, в правой панели она сначала не появляется.
12. Бегунок или не работает или сработал слишком быстро, но запись в информационном поле "Получаю..."
не изменилась.

18:20
Вот уже и Ученый совет закончился, попробую снова настроиться на работу.

ВАЖНО! Вспомнил, в нашей онтологии есть коллизия: есть DatatypeProperty date и есть соглашение по примитивным
типам, где также есть date, но с другим смыслом. Все бы ничего, но date с этим другим смыслом, "цепляет" по 
отношению <range rdf:resource="date"/> совсем не то, что нужно. Короче, надо делать во всех используемых
онтологических файлах замену. Тот date, который DatatypeProperty, мы уже обозвали some-date. 

Все же что происходит с бегунком, он же работал! Или я опять что-то перепутал?

Не удалось заставить бегунок работать. Сделал вычачу процента принятых данных. Теперь надо сделать прерывание 
приема. Сделаю кнопку и задействую ее. 

Задействовал, теперь прервать прием можно. А для того, чтобы его продолжить достаточно те же данные "кинуть" 
в то же место. Есть еще пара недоделок:
13. Если при пересылке данных обнаруживается имеющаяся директория/коллекция, то вся директория отвергается.
А надо бы продолжить, а то могут остаться или появиться непереданные файлы и директории.
14. Надо бы более аккуратно следить за файлами, которые уже пересылались. Во-первых - в части выявления,
во-вторых - в части фиксации. Возможно, надо фиксировать файл в коллекции даже если это копия имеющегося файла.

Теперь попробую визуализировать документ. Пока только фотки.

20101002 08:23
Еще "круглее" дата - в таком написании - полная симметрия. (была бы, если бы дата была 2 января).
Вчера не удалось начать визуализацию. Попробую начать это дело с утра. 

Еще раз отмечу:
*15. Надо разобраться с предвычислениями иконок имиджей. Сейчас это делается неэффективно.

Визуализацию фоток я сделал. Точнее, сделал некоторый начальный вариант. Еще надо будет много чего доделывать. 
В частности, надо иметь возможность смотреть превьюшки в их реальных размерах, сохранять в файле оригинал файла,
воворачивать и изменять размеры превьюшек.

16. Надо для каждой кассеты иметь дефолтные значения. В частности, для размеров превьюшек и потокового видео.

Теперь займусь поворотами. Для начала, найду иконки для команд.

20101004 15:51
Вот почти двое суток занимался поворотами... Думал - быстро сделаю, но уперся в некоторую непростую проблему. 
Если коротко, то суть этой проблемы в том, что по смыслу задачи, нужно формировать и записывать новые 
preview-файлы в соответствии с выполненными преобразованиями. Сами преобразования фиксируются в iisstore, атрибут
transform, в котором (пока) указывается число поворотов по часовой стрелке, необходимое для того, чтобы оригинал
привести к пользовательскому виду (фиксируемому preview-файлами). 
Но поскольку предыдущие варианты маленьких имиджей задействованы на визуальные элементы через ImageSource,
файлы считаются "в работе" и переписать их значение не удавалось. Только ночью, я догадался как это можно 
сделать. Надо формировать ImageSource'ы некоторыми внутренними битмапами, открепленными от файлов. Делается это
довольно просто: сначала формируются нормальные BitmapImage, основанные на графическом файле, потом картинка этого
битмапа копируется в байтовую строку, а потом на базе этой байтовой строки и параметров графики в имидже, 
формируется другой битмап (через BitmapSource.Create(...)) и уже он возвращается в качестве источника имиджа.
 
Схема простая, но трудно было а) определить истинную причину прерывания и б) придумать схему "открепления" источника 
имиджа от файла. 

Проверю, что программа работает и на этой машине. 

Работает, надо только восстановить то, что я отключал, когда отлаживался.

Все восстановил, теперь работает.  

Сделаю четвертый пункт, он важный. Кстати, есть и неудобства в нынешней реализации поворотов:
17. Надо, чтобы после поворота, выделение айтема в правой панели, если оно есть, восстанавливать. 

20101005 16:11
Очень трудно выбрать время для личной работы. Вроде есть немного больше часа, попробую начать. 
Все, вроде, работает. А чего не хватает? Пожелуй, не хватает управления коллекциями и размещением файлов по коллекциям.
Мне кажется, это можно сделать просто. Нужно реализовать создание коллекции, уничтожение файлов и коллекций, 
переименование файлов и коллекций.

Попробую сделать так, чтобы выделенный в правой панели элемент "гасился", т.е. терял выделеие в случае нажатия мышкой
на свободное поле. 

20101006 11:17
Вчера кое-что сделал. В частности, создание новых директорий и открепление файлов и директорий от основного дерева
путем помещения в мусорную корзину. 
Есть и проблемы или что-то вроде проблем. Первое - это именование директорий, а также присваивание директориям
идентификаторов. Здесь нет стройного решения. Я ориентировался на то, что пользователь имеет право повторно добавлять 
серии файлов и директорий в формируемое дерево. Поэтому, предполагалось, что какаф-то директория (коллекция) уже
вводилась. При ее новом вводе, показалось целесообразным сохранять ее идентификатор. А это делается потем формирования
идентификатора через комбинацию текущих имен и имени директории. Заодно, пришлось сделать транслитерацию имен 
директорий, чтобы избавиться от национальных символов (сделано только для русского) и пробелов. Все это не очень 
убедительно и потенциально "дыряво". Надо будет еще подумать над этими проблемами. 
Вторая проблема - имя для новой директории. Сейчас это имя также синтезируется, но это будет неудобно, поскольку
предполагается, что имена будут иметь тематический (осмысленный) характер.  

Попробую поработать над визуализацией видео и документов, а также по предоставлению доступа к оригиналам файлов.

20101009 08:45
Несмотря на отсутствие записей в предыдущие дни, кое-что было сделано. В частности, навел некоторый порядок со
сплиттером, с определением размера wrapPanel, перенес полоску с меню в область правой панели, добился того, что
видео более или менее преобразуется и демонстрируется. Ну, наверное, что-то еще было сделано. Хотя работать в
"рабочее время" становится все сложнее. По поводу preview для видео. Пока принято решение, что создается одна
превьюшка для демонстрации через Интернет в формате .flv, и одна превьюшка - для демонстрации в локальных приложениях,
например кассетном менеджере. Это преобразование производится в конверт avi с микрософтовским вариантом кодека 
MPEG-4. Частота кадров в обеих случаях установлена в 10 гц, размер кадра - 384x288. Кстати, этот размер не годится
для современного видео, надо что-то с этим делать...

Посмотрю свои записи по поводу того, что надо сделать. 

20101013 15:13
Нахожусь в Казане на конференции RCDL-2010, сделал доклад, теперь начну упорядочивать свою работу и
разработку.

Для начала, посмотрю предыдущие записи.

Из первых восьми пожеланий, я сделал или сделал в основном, 6 пунктов. Из двух оставшихся, один (пока) не
носит принципиального характера - это по поводу выделения айтема в ListView в случае перестроения. 
Вторая проблема принципиальна и пора ею заняться. Это устранение дублирования ввода. Продуманный алгоритм
заключается в следующем: 
а) Пусть в конкретную коллекцию помещается конретный файл.
б) файл может быть, а может не быть уже в коллекции, причем коллекции как таковой. 
в) Если файл является дублем уже существующему, однако файл может иметь другое имя (в общем случае - другие 
атрибуты). Что делать в этом случае - пока не придумано. Возможное решение - сделать именование к имеющемуся.
Однако, мы имя файлва пока используем слабо, поэтому этот путь - выглядит сомнительным. Поэтому, мы такие файлы
будем рассматривать как дубли.
г) В случае, когда файл - новый, заводится в базе данных новый документ.
д) В любом случае, мы имеем документ (новый или существующий), который надо связать с текущей коллекцией.
е) Если такая связь существует, то новую создавать не нужно. 
ж) Второй вариант задачи - помещение директории в коллекцию. Здесь возможет простой подход: если в коллекции
имеется подколлекция с указанным имененм, то в качестве следующего уровня целевой коллекции является
эта подколлекция, иначе, подколлекция созадется.
з) Еще один вид отождествления осуществляется в следующем случае - в коллекции есть элемент с основными
атрибутами, совпадающими с вводимым файлом, но контент отличается (если бы контент был бы тем же, то
мы бы уже отожествили элемент с существующим). В этом случае, нужно анализировать временные отметки файлов,
в частности, время последнего изменения, и либо оставлять имеющийся, либо произвести замену. 

Какие "дыры" имеются в данном построении? "Дыра" является опасной, если приводит к потере либо документа,
либо связи документа с директорией. Понятно, что первая опасность, в практическом плане, является более
существенной. Еще пожет быть потеря директорий. Как было указано, уникальный контент всегда будет помещен
в архив. Исключение описано в пункте з. Это исключение существенное и является "дырой". Например, имена 
файлов в электронных камерах обычно имеют тенденцию повоторяться. Если все фотки "валить" в одну коллекцию,
то может поучить данную информационую потерю. Наверное, здесь желательно "ручное" принятие решение. 

Потери директорий, в данном подходе, вроде, не происходит. Единственное, что некоторые директории могут
"склеиться", но это не вглядит страшным. 

Посмотрю код.

В структуре iisstore надо регламентировать, что originalname переведен в ToLower(). Это используется,
в частности, в анализе на совпадение расширений для решения вопроса о тождественности файлов.

20101014 09:23
Вчера в существенной мере переработал метод внесения файла в архив (кассету). Сегодня исправил замеченную
ошибку и пропустил простой тест. Тест показал, что изменения работают, но порождается лишняя связь для
ситуации, когда есть тождественный файл в той же директории. Порождается один документ, но два отношения
вхождения. Поскольку ситуация достаточно очевидная, лучше этого дублирования не делать. Таким образом, 
критерием отказа от создания членства в коллекции, является то, что такая связь уже существует.
Кстати, такой критерий также важен для повторного ввода. Займусь изменением метода.

Изменил, вроде работает.

Теперь надо доделать все действия, связанные с помещением данных в архив. Теперь главное - отследить 
работу с директориями и коллекциями. Там я что-то намудрил с идентификацией коллекций, надо подумать
по всему комплексу вопросов. 

15:08
Вроде, наконец, доделал архивирование файлов и папок. Последнее тестирование прошло успешно.

НАКОНЕЦ-ТО!

Несколько (слабо сказано!) мешает отсутствие визуализации документов. Лучше всего - с фотографиями, они
понятны и в иконках. Хуже всего - с "прочими" документами, там нет визуализации совсем, имя искажено, 
подтип или расширитель - отсутствует. Для начала, хорошо бы сделать доступ к содержимому оригинала. 
Сейчас сделаю по-проще. Сделаю DOS-овский запуск данного файлв. При этом, если в операционной системе есть
дефолтный обработчик файлов данного вида, то именно он и запустится. 

20101017 16:10
Вернулся из командировки, начал "опризодовать" то, что натворил. Поскольку, по неизвестным причинам, студия
перестала работать со XAML основной страницы, я в Казани приостановил работу над ним. Теперь, на моем, 
хоть и завирусованном, но надежно работающем компьютере, снова удалось вернуться к разработке и я сделал
визуализацию оиргиналов документов путем их "запуска". Заработало, хотя это ненадежное решение, по крайней 
мере, позволяющее и уничтожать и редактировать оригиналы. Что неправильно! Причем можно это делать 
неконтролированно. В дальнейшем, обязательно надо будет копировать оригинал и предоставлять к нему доступ.

Теперь отвлекусь от менеджера и поработаю над NoteData. Кстати, может этот проект назвать  NoteFact?

20101020 08:58
Проводил Лену, думал поспать, но что-то не спится. 
Вчера показывал менеджер Алексею Фурсенко, выявилась ошибка в инкрементации индексатора именования файлов.
Как раз недавно я что-то там "колдовал", вот и напортачил... Сейчас посмотрю.

Нашел, ошибка действительно простая и глупая. Удлинил идентификатор метода изменения номера документа и 
поставил его вызов в самый конец обработки документа. 

20101021 12:40
Сегодня поставил менеджер кассет Алексею Фурсенко. Выявилось две неточности, которые там же сразу я устранил. 
Одна неточность - вызов оригинала документа. Если расширение неизвестно операционной системе, то появляется 
Exception. Вторая неточность - отстутствие в списке расширений довольно известного и популярного формата
.mov. Внесу эти изменения в свой оригинал кода.

Внес, можно двигаться дальше.

Посмотрел как работает менеджер на кассете mmf50sborki. Вроде все нормально, только возникает вопрос с пересчетом 
preview по фоткам и по видео. Надо бы это сделать. Еще вопрос - куда сохранять информацию по дефолтной информации.
А еще, я забыл посмотреть сколько используется памяти. 

15:24
Сейчас плотно занялся формированием демонстрационной базы данных для энциклопедии ММФ. Напишу-ко я програмку
конвертирующую базу данных выпускников, созданную студентами в RDF.

Целый час занимался этим вопросом! Очень плохая квалификация...

Теперь соберу решение на ноутбуке.

20101022 11:42
Зря вчера спешил с демонстрацией. Не понадобилась. Думаю, надо будет, когда систему доработаю, просто начать 
работать с отдельными людьми, в частности, с Евгением Гончаровым. Так что есть куда стремиться...

Начну работать над тем, отсутствие чего вчера мешало. Это - переработка материала. Думаю, надо сделать команды:
- перевычислить все фото
- перевычислить все видео
А можно и по одному... Посмотрю код.

20101023 07:58
Вчера плохо работал, надо сегодня сделать рывок. Пока просыпался, кое-что продумал. Нет пока синтаксических 
конструкций, их и надо придумать, а потом - реализовывать. Плохо, что вижу то, что пишу на экране - слабовато...
В очках - нечетко и без очков, также нечетко, поэтому приходится наклоняться.

Во-первых, нужно сформировать дефолтную для кассеты информацию по порождению превьюшек для фото, видео и аудио.
Потом, нужно внедрить в iisstore аналогичную информацию для тех случаев, когда она расходится с дефолтной.
Например, формат дефолтной информации мог бы быть такой:
<image>
	<small previewBase="120" qualityLevel="90" />
	...
</image>	
Ну и аналогично для других размеров. А в iisstore эта информация могла бы иметь следующий формат:
image.small.previewBase="120" image.small.qualityLevel="90"

Для видео, нужна следующая информация:
<video>
	<normal videoBitrate="400K" audioBitrate="22050" />
	...
</video>

16:40
Сегодня у меня сильно болит голова, работать не получается. Однако, попробую еще немного. Для начала,
сделаю ввод дефолтных параметров. А если их нет, то установление этих параметров.

20101024 11:27
Уже около часа работаю. Кажется, сделал дефолтные установки для создания превьюшек. Перчислю их:
image.[small|medium|normal].previewBase - максималный размер превьюшки
image.[small|medium|normal].qualityLevel - уровень сжатия (20-100)
video.medium.videoBitrate - битрэйт для видео-потока
video.medium.audioBitrate - битрэйт для аудио-потока
video.medium.rate - частота кадров
video.medium.size - размер кадра (напр. 384x288)

Пора импытать программу, только сначала надо перевести "телевизор" на воспроизведение medium.

Большое достижение! Я нашел в свободно распространяемом программном обеспечении программу MediaInfo,
которая выявляет метаинформацию о видео и аудио файлах. Попробую ее использовать. Там я могу взять
следующую информацию: width, height, частоту кадров (если нужно) и т.д.

Пример результата анализа видео-файла:

<?xml version="1.0" encoding="UTF-8"?>
<Mediainfo version="0.7.35">
  <File>
    <track type="General">
      <Complete_name>F:\Altai\AltayDzhozator2007.wmv</Complete_name>
      <Format>Windows Media</Format>
      <File_size>653 MiB</File_size>
      <Duration>1h 1mn</Duration>
      <Overall_bit_rate_mode>Constant</Overall_bit_rate_mode>
      <Overall_bit_rate>1 491 Kbps</Overall_bit_rate>
      <Maximum_Overall_bit_rate>1 498 Kbps</Maximum_Overall_bit_rate>
      <Encoded_date>UTC 2007-12-12 18:28:06.171</Encoded_date>
      <Application>Windows Movie Maker 2.1.4026.0</Application>
    </track>

    <track type="Video">
      <ID>2</ID>
      <Format>VC-1</Format>
      <Format_profile>MP@ML</Format_profile>
      <Codec_ID>WMV3</Codec_ID>
      <Codec_ID_Info>Windows Media Video 9</Codec_ID_Info>
      <Codec_ID_Hint>WMV3</Codec_ID_Hint>
      <Description_of_the_codec>Windows Media Video 9 - Professional</Description_of_the_codec>
      <Duration>1h 1mn</Duration>
      <Bit_rate_mode>Constant</Bit_rate_mode>
      <Bit_rate>1 356 Kbps</Bit_rate>
      <Width>720 pixels</Width>
      <Height>576 pixels</Height>
      <Display_aspect_ratio>5:4</Display_aspect_ratio>
      <Frame_rate>25.000 fps</Frame_rate>
      <Standard>PAL</Standard>
      <Bit_depth>8 bits</Bit_depth>
      <Scan_type>Progressive</Scan_type>
      <Bits__Pixel_Frame_>0.131</Bits__Pixel_Frame_>
      <Stream_size>594 MiB (91%)</Stream_size>
      <Language>Russian</Language>
    </track>

    <track type="Audio">
      <ID>1</ID>
      <Format>WMA</Format>
      <Format_version>Version 2</Format_version>
      <Codec_ID>161</Codec_ID>
      <Codec_ID_Info>Windows Media Audio</Codec_ID_Info>
      <Description_of_the_codec>Windows Media Audio 9.1 - 128 kbps, 44 kHz, stereo (A/V) 1-pass CBR</Description_of_the_codec>
      <Duration>1h 1mn</Duration>
      <Bit_rate_mode>Constant</Bit_rate_mode>
      <Bit_rate>128 Kbps</Bit_rate>
      <Channel_s_>2 channels</Channel_s_>
      <Sampling_rate>44.1 KHz</Sampling_rate>
      <Bit_depth>16 bits</Bit_depth>
      <Stream_size>56.1 MiB (9%)</Stream_size>
      <Language>Russian</Language>
    </track>

  </File>
</Mediainfo>

20101029 10:16
Никак не могу справиться с проблемами воспроизведения видео. Уже, казалось, вре работало, но вчера не смог
запустить flv на своем рабочем компьютере. Это при том, что K-Light кодеки я поставил. Пришлось восстанавливать
изготовдение превьюшки формата avi. Но надо двигаться дальше. Сегодня и следующие два выходных для попробую
продвинуться как можно дальше. Хочется иметь: во-первых, демонстрационный комплект хорошего качества, во-вторых,
некоторый вариант энциклопедии. В общем, есть над чем работать. В фокусе моего внимания - две программных системы:
CManager и FGraphSite. Вторую систему, я наверное пересоберу. А еще, похоже деньги за интернет закончились, 
надо сходить и заплатить...

Еще плохо то, что у меня пока не работает студия в режиме WD. Я поставил VS2010 Express, но он требует ввода
ключа, которого я не сумел достать, а теперь без Интернета и не получится. Можно попробовать "снести" эту 
инсталяцию и поставить старый вариант, можно сходить и запрлатить деньги и попробовать достать ключ через 
регистрацию. А регистрацию я не прохожу потому что мой почтовый вход находится на работе. Пора переходить на
современый уровень работы и зарегистрироваться, например в gmail. Вопросы, вопросы...

В последний раз, при испытании менеджера выяснилось, что в программе нет ОЧЕНЬ важной части: заведения рабочего
документа пользователя. Пришлось делать это вручную, а это не слишком удобно. Кстати, периодически "наталкиваюсь"
на неудобство нынешней схемы хранения базы данных в кассете. Там fog-документы заводятся и зранятся на общих 
правах и перемешаны с остальными оригиналами. Какие в этом неудобства. Во-первых, файлы базы данных "перемешаны" с
другими файлами оригиналов. Во-вторых, используется неявная схема вовлечения fog-файлов в модель. В-третьих, 
ослабляется возможность "увода" оригиналов в другую зону хранения. Есть еще замысел порождать компрессованные 
превьюшки fog-файлов, но это уже надо обдумывать отдельно. Тем не менее, есть и достоинства реализованного подхода. 
Это - регулярность структуры кассеты и общие механизмы работы с контентом. Например, в будущем, надо вернуться к
вопросу копий оиригналов и к вопросу кеширования. Тогда желательно иметь общие механизмы. 

У фог-документов есть некоторая особенность - это uri. Дело в том, что uri назначается документу автоматически при
помещении его в кассету. Для фог-документов, почему-то кажется, что нужно иметь также uri "внутри" документа,
т.е. в атрибутах его корневого элемента. При заведении нового документа, синхронизацию внешнего и внутреннего 
uri-идентификаторов произвести несложно. Но как быть в случае уже "сложившегося" fog-документа, который просто 
"внедряется" в кассету? Вообще-то это довольно странная ситуация: почему появился fog-документ вне кассеты? И
зачем нам такой документ внедрять в какую-то кассету? Может, это потребности переходного периода?

20101031 09:55
С некоторым напряжением сделал добавление нового RDF-документа в кассету. При этом, указывается ее владелец.
Не сделал сключение uri документа в атрибуты документного файла. Это вроде не срочно. Теперь можно приостановиться
в совершенствованиях и попробовать поработать с Web-интерфейсом. Тем более, что я активировал студию 2010 в 
WD-режиме. Начну, пожалуй...

20101101 15:10
Опять единички и нолики в дате...
Надо сделать корректное изменение размера кадра вычисляемого потокового видео. Думаю, надо опираться на вертикальный 
размер и aspect ratio. Для начала, еще раз попробую работу менеджера на моем компьютере и попробую установить причину 
невоспроизведения flv-файлов.

20101104 13:02

Сегодня какой-то праздник, еще не выучил его названия. Но это повод в течение четырех дней "отдаться" любимому делу.
Была идея съездить на Алтай и походить по горам, но Филиппов оказался занятым, мне тоже надо побывать на Поттосинской
олимпиаде, да и погода какая-то сырая, наверное, в горах уже снег. 

Вчера серьезно поработали с Сергеем и некоторый демонстрационный вариант Веб-приложения для энциклопедии собрали. 
Решил позаниматься контентом, доделками и приведением всего "хозяйства" к демонстрабельному виду. У меня есть 
два главных для нынешних экспериментов ресурса: кассета с документами выпуска 77 года и полный список выпускников
ММФ до 2005 года. Другие моменты можно будет рассматривать как тестовые, но эти ресурсы пора включать в оборот.
Первая задача, которая стоит передо мной - дооформить кассету. Для этого надо:
- перевычислить превьшки, причем как по фоткам, так и по видео;
- что-то там случайно затесалось в кассету, это что-то надо (вручную) вычистить, а может сначала сделать подходящий 
инструмент в менеджере;
- наверное, еще что-то нужно сделать, но это будет видно по ходу дела.

20101126 11:16
Прошло 2 недели, как я в последний раз работал над проектом. За это время серьезных претензий
не выявилось. Но нужно продолжать тестирование и улучшать функционалность. Потрачу немного времени
для очередной проверки.

Сделать, чтобы некоторые виды документов визуализировались напрямую, а не через системную
визуализацию. Это касается плоского текста, аудио-документов и, возможно, html-документов.

Начну с текстов. 

Начал не с текстов, а с аудио. Выяснилось, что аудио-документы и не формируются вовсе. И вообще,
вся "кухня", связанная с документами и их визуализацией, излишне громоздкая. Наверное, сейчас
ее переделывать нет оснований, но в дальнейшем, надо бы обратить на правильность оформления
файлов контента, простоту и логику в их переработках и предоставления к ним доступа. 

20101130 06:45
Лештаев сделал изменения в SGraph и Cassette, у него эти модули теперь работают, а у меня - нет.
Надо адаптироваться. 

20110116 12:05
Новый 2011 год! Пора заняться совершенствованием кассетного менеджера. Есть конкретные потребности:
1. Сделать конвертацию аудио-документов в правильные форматы (сейчас получилось по архиву Гончарова,
что это просто документы)
2. Обеспечить прослушивание этих аудио-документов
3. Начать работу по дополнительной обработке и сортировке базы документов. Эта работа на первом
этапе будет состоять из разметки значимости документов и в приписке документов сформированным
коллекциям.

Начну с первых двух пунктов. Посмотрю код.

21:04
Первый пункт сделал, но выявилась ошибка или неточность: при двойном нажатии на аудиоиконку ничего не
происходит. Надо ее устранить и сделать визуализацию (исполнение) аудио-файлов. 

20110121 08:42
Показалось, что визуализация широкоформатного видео производится на экране увеличенного размера, 
надо проверить.

11:18
Все думаю по поводу системы "тегов". Текущая идея заключается в том, чтобы пользователю дать 
возможность набрать коллекции под формируемое меню. Пока был сделан и встроен в менеджер только
один тег "дайжест". Это неплохо, но маловато. Наверное, решение должно быть более гибким:
надо ввести в формирование кассеты понятие "меню", дать возможность пользователю его сформировать,
дать возможность пользователю "разбросать" фотки по пунктам этого меню. 

Но пока есть смысл сделать выборку из наших непальских фотографий и видео-фрагментов, т.е. создать 
коллекцию "дайжест". Поскольку такой коллекции менеджер не создает, надо создать ее руками. И надо 
попробовать просмотреть фотки. Научу-ка я Лену.

20110122 10:47
Процесс выделения фоток для дайжеста пошел. Но теперь Лена просит еше и разделить фото-рассказ по
главным темам. Но тогда надо сделать множество коллекций или точнее, множество пунктов меню к
которым "прикреплять" документы. Нужно ли иметь в кассете систему меню или нет? Или достаточно при
настройке кассеты на приложение указать какие директории или другие объекты составят меню.

Попробую это сделать с меню. Пусть в кассете заводится директория с именем menu. А еще лучше 
по-другому: пусть есть "внешняя" или виртуальная коллекция с идентификатором, например, 
rootmenucollection (по аналогии с уже работющим решением). Тогда можно на уровне менеджера
управлять этим меню. В данном случае, даже можно этой части программы не писать, а выполнить
действия вручную. Как это использовать? Менеджер находит все коллекции или другие объекты, которые
ведут в меню и располагает в "кнопочной" зоне быстрое связывание. Ну а далее - более или менее 
понятно что надо делать. Попробую это внедрить в код. Пока только на уровне коллекций.

20110123 11:25
Вернулся к записям в дневнике, хотя работал уже с раннего утра и уже сумел сделать достаточно 
принципиальные изменения. Короче, теперь можно задавать коллекции для меню, делая их подколлекциями 
виртуальной коллекции menurootcollection. Все работает, однако есть замечания:
- нужно иметь возможность смотреть и модифицировать меню-коллекции;
- хорошо бы иметь встроенные возможности управления разделами меню; 
- хорошо бы в виде меню использовать и другие типы сущностей: персоны, организационные системы
и т.д.

Есть еще одна неточность, по которой надо будет поработать: появляющиеся элементы в меню-коллекциях
ведут себя несколько "ограниченно", в частности, не реагируют на двойной клик. Наверное, дело в
том что к айтему не "прикреплен" хэндлер. Но это - потом, а самое срочное - обработка фоток нашего
похода. Сделаю я просмотр меню-коллекций.

20110302 14:37
При преобразовании фотоархива в кассеты возникли разные вопросы. То, что касается кассетного менеджера -
работа с дефектными фотками. Фотография может быть слишком большой или иметь внутренние дефекты. Тогда
не визуализируется ни маленькая, и большая превьюшки. Нужно:
а) обеспечить читаемость и обрабатываемость оригинала;
б) выполнить создание превьюшек или повернуть фотку. 

Второе действие можно осуществить поворотами. Если поворачисать не нужно, то можно повернуть дважды, 
по часовой и против часовой стрелки. А для первого действия нужно средство. Предполагаю, что таким  
средством может быть замена оригинала с дальнейшим выполнением предвычислений. Базу данных менять почти 
не нужно. Только проверить то, что файл того же типа (фото-видео-аудио). А также изменить на новые 
специальные поля, касающиеся файла - длину файла, контрольную сумму (пока я ее не вычисляю), пиксельные 
размерности. Ну и соответственно, перевычислить превьюшки. Кнопку я размещу на второй управляющей панели
там же где и повороты. Это логично, поскольку для выполнения действия нужно иметь отмеченный файл. 
Кстати, как будет выделяться ненарисованная микрофотка? Посмотрим... Приступлю к кодированию.

20110409 13:24
Сегодня работаю дома. Планов громадьё, но, как часто бывает, все движется довольно медленно.
На первую проблему наткнулся пытаясь заставить работать CManager со сканами для получения формата 
DeepZoom. Оказалось, что в последней версии в репозитории нет нужных частей обработки. Пришлось
"вручную" искать эти части кода по предыдущим версиям и восстанавливать работоспособность системы.
Потратил на это часа три. Впредь надо быть внимательнее... Сейчас версия восстановлена и по мелочам
несколько улучшена. Что осталось? Некоторое неудобство вызывает постоянное предывание варианта 
контекстного меню, связанного в выдачей строки запуска DeepZoom из html. Но пока этот момент выправлять
не буду. Двинусь дальше. Теперь надо убедиться, что полученная кассета с DeepZoom работоспособна.

20110515 10:15
Сейчас я "вернулся" из другого проекта - проекта Публикуем, где настала пора приписывать записи
базы данных архиву. На стадии работы с документами это затрагивает CManager. Теперь предполагаются
следующие изменения в менеджере. 
1. В конфигурационный файл кассеты .finfo вводим поле
<archive id="идентификатор архива" source="идентификатор источника информации"/>
2. При вводе документов, проставляем "членство" в архиве для всех документов, попадающих в архив.
3. Делаем кнопку "Приписать архиву", по нажатию на которую все документы кассеты, НЕ ИМЕЮЩИЕ архивной
приписки, будут приписываться к архиву, определенному в .finfo.

В этом подходе есть определенные неудобства. Первое неудобство - идентификаторы архива и источника.
Откуда пользователю их узнать? В нашем мехматовском случае это достаточно просто, хотя и не сильно
удобно. Сейчас про это думать не стоит.
Второе неудобство - статичнось приписки элементам к одному архиву (это логично) и к одному источнику
(это менее логично). Также момент кажется неактуальным, подумаю над ним когда буду заниматься
концептуализацией.

20110707 18:37
Начинается "школьная" жизнь!
  



  
	

 





  

 

  



 

   